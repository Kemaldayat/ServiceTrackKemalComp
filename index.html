<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kemal Computer - Cek Status & Informasi</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
    <style>
        /* Specific styles for index.html */
        .header-public {
            text-align: center;
            margin-bottom: 40px;
        }
        .header-public img {
            max-width: 150px;
            margin-bottom: 15px;
            border-radius: 8px; /* Optional: subtle rounding */
        }
        .header-public h1 {
            color: var(--primary-color); /* Using CSS variable from style.css */
            font-size: 2.8em;
            margin-bottom: 10px;
        }
        .header-public p {
            color: var(--text-color-light);
            font-size: 1.1em;
            margin-bottom: 5px;
        }
        .contact-info {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        .contact-info div {
            display: flex;
            align-items: center;
            font-size: 1.1em;
            color: var(--text-color);
        }
        .contact-info i {
            margin-right: 10px;
            color: var(--accent-color);
            font-size: 1.3em;
        }

        .section-title {
            text-align: center;
            color: var(--primary-color);
            margin-top: 40px;
            margin-bottom: 25px;
            font-size: 2em;
            border-bottom: 2px solid var(--accent-color);
            padding-bottom: 10px;
            display: inline-block; /* To make border-bottom fit content */
        }

        .search-form {
            max-width: 500px;
            margin: 0 auto 30px auto;
            padding: 25px;
            background-color: var(--light-bg);
            border-radius: 8px;
            box-shadow: var(--shadow-sm);
        }
        .search-form label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
            color: var(--text-color);
        }
        .search-form input[type="text"] {
            width: calc(100% - 24px); /* Adjust for padding and border */
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            font-size: 1em;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
        }
        .search-form button {
            width: 100%;
            padding: 12px 20px;
            background-color: var(--success-color);
            color: white;
            border: none;
            border-radius: var(--border-radius-sm);
            font-size: 1.1em;
            cursor: pointer;
            transition: var(--transition-ease);
            margin-top: 20px;
        }
        .search-form button:hover {
            background-color: var(--success-hover);
        }

        #resultContainer {
            margin-top: 20px;
            padding: 20px;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-md);
            background-color: var(--light-bg);
            text-align: left;
            min-height: 120px;
            box-shadow: var(--shadow-sm);
        }
        #resultContainer p {
            margin-bottom: 8px;
            font-size: 1em;
            color: var(--text-color);
        }
        #resultContainer strong {
            color: var(--primary-color);
        }
        .result-not-found {
            color: var(--danger-color);
            font-weight: bold;
            text-align: center;
            font-size: 1.1em;
            padding: 15px 0;
        }

        .map-section {
            text-align: center;
            margin-top: 50px;
            margin-bottom: 40px;
        }
        .map-section iframe {
            width: 100%;
            max-width: 800px;
            height: 450px;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius-md);
            box-shadow: var(--shadow-md);
        }

        .admin-link {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }
        .admin-link a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: bold;
            font-size: 1.1em;
        }
        .admin-link a:hover {
            text-decoration: underline;
        }

        /* WhatsApp Button specific styles */
        .whatsapp-button {
            display: inline-flex; /* Use inline-flex for proper icon alignment */
            align-items: center; /* Vertically align icon and text */
            gap: 10px; /* Space between icon and text */
            background-color: #25D366; /* WhatsApp Green */
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: var(--border-radius-sm);
            font-size: 1.1em;
            text-decoration: none;
            margin-top: 30px;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.3s ease;
            box-shadow: var(--shadow-sm);
        }
        .whatsapp-button:hover {
            background-color: #1DA851; /* Darker green on hover */
            transform: translateY(-2px); /* Slight lift effect */
        }
        .whatsapp-button i {
            font-size: 1.3em;
        }

        /* Background Service Section */
        .service-info-section {
            background: url('./images/Bg.jpg') no-repeat center center / cover; /* Background image */
            color: white; /* Text color on background */
            padding: 50px 20px;
            margin-top: 50px;
            border-radius: var(--border-radius-lg);
            text-align: center;
            box-shadow: var(--shadow-md);
            position: relative; /* For overlay */
            overflow: hidden;
        }
        /* Optional: Add a subtle overlay to make text more readable on busy backgrounds */
        .service-info-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.4); /* Dark overlay */
            border-radius: var(--border-radius-lg);
            z-index: 1;
        }
        .service-info-section > * {
            position: relative;
            z-index: 2; /* Ensure content is above overlay */
        }
        .service-info-section h2 {
            font-size: 2.5em;
            margin-bottom: 20px;
            color: white; /* Ensure title is white */
            text-shadow: 1px 1px 3px rgba(0,0,0,0.5);
        }
        .service-info-section p {
            font-size: 1.2em;
            max-width: 700px;
            margin: 0 auto 30px auto;
            line-height: 1.8;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.5);
        }

        /* Responsive adjustments for index.html */
        @media (max-width: 768px) {
            .header-public h1 {
                font-size: 2.2em;
            }
            .contact-info {
                flex-direction: column;
                gap: 15px;
            }
            .search-form {
                padding: 20px;
            }
            .map-section iframe {
                height: 300px;
            }
            .whatsapp-button {
                padding: 10px 20px;
                font-size: 1em;
            }
            .service-info-section {
                padding: 30px 15px;
            }
            .service-info-section h2 {
                font-size: 2em;
            }
            .service-info-section p {
                font-size: 1.1em;
            }
        }
        @media (max-width: 480px) {
            .header-public h1 {
                font-size: 1.8em;
            }
            .header-public p, .contact-info div {
                font-size: 1em;
            }
            .section-title {
                font-size: 1.8em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header-public">
            <img src="./images/logo.png" alt="Logo Kemal Computer">
            <h1>Kemal Computer Service</h1>
            <p>Solusi Terbaik untuk Perbaikan Perangkat Anda</p>
            <div class="contact-info">
                <div><i class="fas fa-phone"></i> Nomor Admin: +62 812-3456-7890</div>
                <div><i class="fab fa-instagram"></i> Instagram: @kemalcomputer</div>
            </div>
            <a href="https://wa.me/6281234567890" target="_blank" class="whatsapp-button">
                <i class="fab fa-whatsapp"></i> Hubungi Admin
            </a>
        </header>

        <section class="service-info-section">
            <h2>Tentang Layanan Kami</h2>
            <p>
                Kami menyediakan layanan perbaikan komputer dan perangkat elektronik dengan cepat, handal, dan bergaransi.
                Tim teknisi berpengalaman kami siap mengatasi berbagai jenis kerusakan, mulai dari software hingga hardware.
                Percayakan perangkat Anda kepada kami!
            </p>
        </section>

        <h2 class="section-title">Cek Status Layanan Anda</h2>
        <form id="checkStatusForm" class="search-form">
            <div>
                <label for="serviceCode">Masukkan Kode Service:</label>
                <input type="text" id="serviceCode" placeholder="Contoh: KC-YYMMDD-HHMMSS-RANDOM" required>
            </div>
            <button type="submit"><i class="fas fa-search"></i> Cek Status</button>
        </form>

        <div id="resultContainer" class="table-responsive">
            <p style="text-align: center; color: var(--text-color-light);">Masukkan kode service untuk melihat status layanan Anda.</p>
        </div>

        <h2 class="section-title">Lokasi Kami</h2>
        <section class="map-section">
            <iframe
                src="https://maps.app.goo.gl/MRPgPuMSN6N2UA1e8"
                allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade">
            </iframe>
        </section>

        <footer class="admin-link">
            <p>Khusus Admin: <a href="login.html">Login Admin</a></p>
        </footer>
    </div>

    <script type="module">
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDRvkYXHUb42q2H8F_2687CTihtDDNuYQ4",
            authDomain: "website-track-service.firebaseapp.com",
            databaseURL: "https://website-track-service-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "website-track-service",
            storageBucket: "website-track-service.firebasestorage.app",
            messagingSenderId: "87573564376",
            appId: "1:87573564376:web:c93c07f0506d00535a00ad",
            measurementId: "G-64T8XNWK5F"
        };

        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js";
        import { getDatabase, ref, get, child } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-database.js";

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        document.getElementById('checkStatusForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const serviceCode = document.getElementById('serviceCode').value.trim();
            const resultContainer = document.getElementById('resultContainer');
            resultContainer.innerHTML = ''; // Clear previous results

            if (!serviceCode) {
                resultContainer.innerHTML = '<p class="result-not-found">Mohon masukkan kode service.</p>';
                return;
            }

            try {
                const dbRef = ref(db);
                const snapshot = await get(child(dbRef, `antrian/${serviceCode}`));

                if (snapshot.exists()) {
                    const service = snapshot.val();
                    let statusBadgeClass = '';
                    switch (service.status) {
                        case 'Menunggu': statusBadgeClass = 'status-waiting'; break;
                        case 'Proses': statusBadgeClass = 'status-process'; break;
                        case 'Selesai': statusBadgeClass = 'status-finished'; break;
                        case 'Diambil': statusBadgeClass = 'status-picked-up'; break;
                        default: statusBadgeClass = ''; // Default or unknown status
                    }
                    
                    // Format the timestamp for better readability
                    const date = new Date(service.timestamp);
                    const formattedDate = date.toLocaleDateString('id-ID', {
                        year: 'numeric', month: 'long', day: 'numeric',
                        hour: '2-digit', minute: '2-digit', second: '2-digit'
                    });

                    resultContainer.innerHTML = `
                        <p><strong>Kode Service:</strong> ${serviceCode}</p>
                        <p><strong>Nama Pelanggan:</strong> ${service.nama}</p>
                        <p><strong>Jenis Device:</strong> ${service.device || '-'}</p>
                        <p><strong>Deskripsi Kerusakan:</strong> ${service.kerusakan}</p>
                        <p><strong>Nomor HP:</strong> ${service.nomorHp || '-'}</p>
                        <p><strong>Status:</strong> <span class="status-badge ${statusBadgeClass}">${service.status}</span></p>
                        ${service.keterangan ? `<p><strong>Keterangan:</strong> ${service.keterangan}</p>` : ''}
                        <p><strong>Tanggal Masuk:</strong> ${formattedDate}</p>
                    `;
                } else {
                    resultContainer.innerHTML = '<p class="result-not-found">Kode service tidak ditemukan. Mohon periksa kembali.</p>';
                }
            } catch (error) {
                console.error("Error checking service status:", error);
                resultContainer.innerHTML = '<p class="result-not-found">Terjadi kesalahan saat mencari status. Silakan coba lagi.</p>';
            }
        });
    </script>
</body>
</html>
