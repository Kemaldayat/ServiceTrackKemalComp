<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kemal Computer - Cek Status & Informasi</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <style>
        /* Specific styles for index.html */
        body {
            font-family: 'Poppins', sans-serif; /* Menggunakan Poppins sebagai font dasar */
        }

        .header-public {
            text-align: center;
            margin-bottom: 40px;
        }
        .header-public img {
            max-width: 150px;
            margin-bottom: 15px;
            border-radius: 8px; /* Optional: subtle rounding */
        }
        .header-public h1 {
            color: var(--primary-color);
            font-size: 2.8em;
            margin-bottom: 10px;
        }
        .header-public p.tagline { /* Menambahkan class tagline untuk target styling */
            color: var(--text-color-light);
            font-family: 'Playfair Display', serif; /* Font menarik untuk tagline */
            font-size: 1.3em; /* Sedikit lebih besar */
            margin-bottom: 5px;
            font-weight: 600; /* Lebih tebal */
            text-shadow: 0 1px 2px rgba(0,0,0,0.1); /* Sedikit bayangan */
        }

        .section-title {
            text-align: center;
            color: var(--primary-color);
            margin-top: 40px;
            margin-bottom: 25px;
            font-size: 2em;
            border-bottom: 2px solid var(--accent-color);
            padding-bottom: 10px;
            display: inline-block;
        }

        .search-form {
            max-width: 500px;
            margin: 0 auto 30px auto;
            padding: 25px;
            background-color: var(--light-bg);
            border-radius: 8px;
            box-shadow: var(--shadow-sm);
        }
        .search-form label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
            color: var(--text-color);
        }
        .search-form input[type="text"] {
            width: calc(100% - 24px);
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            font-size: 1em;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
        }
        .search-form button {
            width: 100%;
            padding: 12px 20px;
            background-color: var(--success-color);
            color: white;
            border: none;
            border-radius: var(--border-radius-sm);
            font-size: 1.1em;
            cursor: pointer;
            transition: var(--transition-ease);
            margin-top: 20px;
        }
        .search-form button:hover {
            background-color: var(--success-hover);
        }

        #resultContainer {
            margin-top: 20px;
            padding: 20px;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-md);
            background-color: var(--light-bg);
            text-align: left;
            min-height: 120px;
            box-shadow: var(--shadow-sm);
        }
        #resultContainer p {
            margin-bottom: 8px;
            font-size: 1em;
            color: var(--text-color);
        }
        #resultContainer strong {
            color: var(--primary-color);
        }
        .result-not-found {
            color: var(--danger-color);
            font-weight: bold;
            text-align: center;
            font-size: 1.1em;
            padding: 15px 0;
        }

        .map-section {
            text-align: center;
            margin-top: 50px;
            margin-bottom: 40px;
        }
        .map-section p.address {
            margin-bottom: 20px;
            font-size: 1.1em;
            color: var(--text-color);
            line-height: 1.5;
        }
        .map-section iframe {
            width: 100%;
            max-width: 800px;
            height: 450px;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius-md);
            box-shadow: var(--shadow-md);
        }

        footer {
            text-align: center;
            margin-top: 50px;
            padding-top: 30px;
            border-top: 1px solid var(--border-color);
            color: var(--text-color);
        }
        footer .contact-info-footer {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        footer .contact-info-footer div {
            display: flex;
            align-items: center;
            font-size: 1em;
            color: var(--text-color-light);
        }
        footer .contact-info-footer i {
            margin-right: 8px;
            color: var(--primary-color);
            font-size: 1.2em;
        }
        footer .admin-link {
            margin-top: 15px;
        }
        footer .admin-link a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: bold;
            font-size: 1em;
        }
        footer .admin-link a:hover {
            text-decoration: underline;
        }

        /* WhatsApp Button (TRIGGER) specific styles - make it smaller */
        .whatsapp-button-trigger {
            background-color: var(--primary-color); /* Menggunakan warna primary tema */
            color: white;
            padding: 8px 15px; /* Lebih kecil */
            border: none;
            border-radius: var(--border-radius-sm);
            font-size: 0.9em; /* Font lebih kecil */
            text-decoration: none;
            margin-top: 20px; /* Jarak dari tagline */
            cursor: pointer;
            transition: var(--transition-ease);
            box-shadow: var(--shadow-sm);
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        .whatsapp-button-trigger:hover {
            background-color: var(--primary-hover);
            transform: translateY(-2px);
        }
        .whatsapp-button-trigger i {
            font-size: 1.1em;
        }

        /* Modal for WhatsApp contact */
        .modal-whatsapp {
            display: none; /* Hidden by default */
            position: fixed; /* Stay in place */
            z-index: 1000; /* Sit on top */
            left: 0;
            top: 0;
            width: 100%; /* Full width */
            height: 100%; /* Full height */
            overflow: auto; /* Enable scroll if needed */
            background-color: rgba(0,0,0,0.6); /* Black w/ opacity */
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .modal-whatsapp-content {
            background-color: var(--container-bg);
            margin: auto;
            padding: 30px;
            border-radius: var(--border-radius-md);
            box-shadow: var(--shadow-md);
            text-align: center;
            position: relative;
            max-width: 400px;
            animation: fadeIn 0.3s ease-out;
        }

        .modal-whatsapp-content h3 {
            color: var(--primary-color);
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .modal-whatsapp-content p {
            margin-bottom: 25px;
            font-size: 1em;
            color: var(--text-color);
        }

        .modal-whatsapp-content .close-button-whatsapp {
            color: #aaa;
            position: absolute;
            top: 10px;
            right: 20px;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .modal-whatsapp-content .close-button-whatsapp:hover,
        .modal-whatsapp-content .close-button-whatsapp:focus {
            color: var(--danger-color);
            text-decoration: none;
            cursor: pointer;
        }

        .modal-whatsapp-content .whatsapp-link-button {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background-color: #25D366; /* WhatsApp Green */
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: var(--border-radius-sm);
            font-size: 1.1em;
            text-decoration: none;
            transition: background-color 0.3s ease, transform 0.3s ease;
        }
        .modal-whatsapp-content .whatsapp-link-button:hover {
            background-color: #1DA851;
            transform: translateY(-2px);
        }
        .modal-whatsapp-content .whatsapp-link-button i {
            font-size: 1.3em;
        }

        /* Background Service Section */
        .service-info-section {
            background: url('./images/bg.jpg') no-repeat center center / cover;
            color: white;
            padding: 50px 20px;
            margin-top: 50px;
            border-radius: var(--border-radius-lg);
            text-align: center;
            box-shadow: var(--shadow-md);
            position: relative;
            overflow: hidden;
        }
        .service-info-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.4);
            border-radius: var(--border-radius-lg);
            z-index: 1;
        }
        .service-info-section > * {
            position: relative;
            z-index: 2;
        }
        .service-info-section h2 {
            font-size: 2.5em;
            margin-bottom: 20px;
            color: white;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.5);
        }
        .service-info-section p {
            font-size: 1.2em;
            max-width: 700px;
            margin: 0 auto 30px auto;
            line-height: 1.8;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.5);
        }

        /* Responsive adjustments for index.html */
        @media (max-width: 768px) {
            .header-public h1 {
                font-size: 2.2em;
            }
            .header-public p.tagline {
                font-size: 1.1em;
            }
            .search-form {
                padding: 20px;
            }
            .map-section iframe {
                height: 300px;
            }
            .whatsapp-button-trigger {
                padding: 7px 12px;
                font-size: 0.85em;
            }
            .service-info-section {
                padding: 30px 15px;
            }
            .service-info-section h2 {
                font-size: 2em;
            }
            .service-info-section p {
                font-size: 1.1em;
            }
            footer .contact-info-footer {
                flex-direction: column;
                gap: 10px;
            }
        }
        @media (max-width: 480px) {
            .header-public h1 {
                font-size: 1.8em;
            }
            .header-public p.tagline {
                font-size: 1em;
            }
            .section-title {
                font-size: 1.8em;
            }
            footer .contact-info-footer div {
                font-size: 0.95em;
            }
            .modal-whatsapp-content {
                max-width: 90%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header-public">
            <img src="./images/logo.png" alt="Logo Kemal Computer">
            <h1>Kemal Computer Service</h1>
            <p class="tagline">Solusi Terbaik untuk Perbaikan Perangkat Anda</p>
            <button class="whatsapp-button-trigger" id="openWhatsappModal">
                <i class="fab fa-whatsapp"></i> Hubungi Admin
            </button>
        </header>

        <section class="service-info-section">
            <h2>Tentang Layanan Kami</h2>
            <p>
                Kami menyediakan layanan perbaikan komputer dan perangkat elektronik dengan cepat, handal, dan bergaransi.
                Tim teknisi berpengalaman kami siap mengatasi berbagai jenis kerusakan, mulai dari software hingga hardware.
                Percayakan perangkat Anda kepada kami!
            </p>
        </section>

        <h2 class="section-title">Cek Status Layanan Anda</h2>
        <form id="checkStatusForm" class="search-form">
            <div>
                <label for="serviceCode">Masukkan Kode Service:</label>
                <input type="text" id="serviceCode" placeholder="Contoh: KC-YYMMDD-HHMMSS-RANDOM" required>
            </div>
            <button type="submit"><i class="fas fa-search"></i> Cek Status</button>
        </form>

        <div id="resultContainer" class="table-responsive">
            <p style="text-align: center; color: var(--text-color-light);">Masukkan kode service untuk melihat status layanan Anda.</p>
        </div>

        <h2 class="section-title">Lokasi Kami</h2>
        <section class="map-section">
            <p class="address">
                Gg. Serai No.127B, Tempel, Caturtunggal, Kec. Depok, Kabupaten Sleman, Daerah Istimewa Yogyakarta 55281, Indonesia
            </p>
            <iframe
                src="https://maps.google.com/?cid=8752713075951597851"
                allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade">
            </iframe>
        </section>

        <footer>
            <div class="contact-info-footer">
                <div><i class="fas fa-phone"></i> Nomor Admin: +62 882-2897-7367</div>
                <div><i class="fab fa-instagram"></i> Instagram: @Kemal_Computer</div>
            </div>
            <div class="admin-link">
                <p>Khusus Admin: <a href="login.html">Login Admin</a></p>
            </div>
        </footer>
    </div>

    <div id="whatsappModal" class="modal-whatsapp">
        <div class="modal-whatsapp-content">
            <span class="close-button-whatsapp">&times;</span>
            <h3>Hubungi Admin Kami</h3>
            <p>Silakan pilih cara Anda ingin menghubungi kami via WhatsApp:</p>
            <a href="https://wa.me/6288228977367?text=Halo%20Kemal%20Computer,%20saya%20ingin%20bertanya%20mengenai%20layanan%20service." target="_blank" class="whatsapp-link-button">
                <i class="fab fa-whatsapp"></i> Chat WhatsApp
            </a>
        </div>
    </div>

    <script type="module">
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDRvkYXHUb42q2H8F_2687CTihtDDNuYQ4",
            authDomain: "website-track-service.firebaseapp.com",
            databaseURL: "https://website-track-service-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "website-track-service",
            storageBucket: "website-track-service.firebasestorage.app",
            messagingSenderId: "87573564376",
            appId: "1:87573564376:web:c93c07f0506d00535a00ad",
            measurementId: "G-64T8XNWK5F"
        };

        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js";
        import { getDatabase, ref, get, child } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-database.js";

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        // Get the modal elements
        const whatsappModal = document.getElementById('whatsappModal');
        const openWhatsappModalBtn = document.getElementById('openWhatsappModal');
        const closeWhatsappModalBtn = document.getElementsByClassName('close-button-whatsapp')[0];

        // When the user clicks the button, open the modal
        openWhatsappModalBtn.onclick = function() {
            whatsappModal.style.display = 'flex'; // Use flex to center
        }

        // When the user clicks on <span> (x), close the modal
        closeWhatsappModalBtn.onclick = function() {
            whatsappModal.style.display = 'none';
        }

        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
            if (event.target == whatsappModal) {
                whatsappModal.style.display = 'none';
            }
        }

        document.getElementById('checkStatusForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const serviceCode = document.getElementById('serviceCode').value.trim();
            const resultContainer = document.getElementById('resultContainer');
            resultContainer.innerHTML = ''; // Clear previous results

            if (!serviceCode) {
                resultContainer.innerHTML = '<p class="result-not-found">Mohon masukkan kode service.</p>';
                return;
            }

            try {
                const dbRef = ref(db);
                const snapshot = await get(child(dbRef, `antrian/${serviceCode}`));

                if (snapshot.exists()) {
                    const service = snapshot.val();
                    let statusBadgeClass = '';
                    switch (service.status) {
                        case 'Menunggu': statusBadgeClass = 'status-waiting'; break;
                        case 'Proses': statusBadgeClass = 'status-process'; break;
                        case 'Selesai': statusBadgeClass = 'status-finished'; break;
                        case 'Diambil': statusBadgeClass = 'status-picked-up'; break;
                        default: statusBadgeClass = ''; // Default or unknown status
                    }
                    
                    // Format the timestamp for better readability
                    const date = new Date(service.timestamp);
                    const formattedDate = date.toLocaleDateString('id-ID', {
                        year: 'numeric', month: 'long', day: 'numeric',
                        hour: '2-digit', minute: '2-digit', second: '2-digit'
                    });

                    resultContainer.innerHTML = `
                        <p><strong>Kode Service:</strong> ${serviceCode}</p>
                        <p><strong>Nama Pelanggan:</strong> ${service.nama}</p>
                        <p><strong>Jenis Device:</strong> ${service.device || '-'}</p>
                        <p><strong>Deskripsi Kerusakan:</strong> ${service.kerusakan}</p>
                        <p><strong>Nomor HP:</strong> ${service.nomorHp || '-'}</p>
                        <p><strong>Status:</strong> <span class="status-badge ${statusBadgeClass}">${service.status}</span></p>
                        ${service.keterangan ? `<p><strong>Keterangan:</strong> ${service.keterangan}</p>` : ''}
                        <p><strong>Tanggal Masuk:</strong> ${formattedDate}</p>
                    `;
                } else {
                    resultContainer.innerHTML = '<p class="result-not-found">Kode service tidak ditemukan. Mohon periksa kembali.</p>';
                }
            } catch (error) {
                console.error("Error checking service status:", error);
                resultContainer.innerHTML = '<p class="result-not-found">Terjadi kesalahan saat mencari status. Silakan coba lagi.</p>';
            }
        });
    </script>
</body>
</html>
